{% extends '../layouts/base.html' %}

{% block main %}
<div class="mb-3 mt-2"><a href="/" style="text-decoration: none;">Trang chủ</a> / {{ product.title }}</div>
<div class="row">
  <div class="col-6">
    <div id="carouselExampleFade" class="carousel slide carousel-fade">
      <div class="carousel-inner rounded">
        <div class="carousel-item active">
          <img src="{{ product.img1 }}" class="d-block w-100" alt="Ảnh sản phẩm 1" style="aspect-ratio: 208/181; overflow: hidden; object-fit: cover;">
        </div>
        {% if product.img2 %}
        <div class="carousel-item">
          <img src="{{ product.img2 }}" class="d-block w-100" alt="Ảnh sản phẩm 2" style="aspect-ratio: 208/181; overflow: hidden; object-fit: cover;">
        </div>
        {% endif %}
        {% if product.img3 %}
        <div class="carousel-item">
          <img src="{{ product.img3 }}" class="d-block w-100" alt="Ảnh sản phẩm 3" style="aspect-ratio: 208/181; overflow: hidden; object-fit: cover;">
        </div>
        {% endif %}
        {% if product.img4 %}
        <div class="carousel-item">
          <img src="{{ product.img4 }}" class="d-block w-100" alt="Ảnh sản phẩm 4" style="aspect-ratio: 208/181; overflow: hidden; object-fit: cover;">
        </div>
        {% endif %}
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleFade" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleFade" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  </div>
  <div class="col-6">
    <span style="font-size: 25px;">{{ product.title|upper }}</span> <br> <br>
    {% if product.category %}
    <span style="font-size: 18px;">Dòng sản phẩm: {{ product.category.name }}</span> <br>
    {% endif %}
    {% if product.element %}
    <span style="font-size: 18px;">Hợp: {{ product.element.name }}</span> <br>
    {% endif %}
    <br>
    {% if product.sale_price %}
    <span style="font-size: 20px;">{{ product.sale_price }}₫</span>
    <strike>{{ product.price }}₫</strike>
    {% else %}
    <span style="font-size: 20px;">{{ product.price }}₫</span>
    {% endif %}
    <br>
    <hr>
    <span>Mô tả: {{ product.description }}</span>
    <hr>
    <div class="d-flex gap-3 mb-3" style="align-items: center;"> Số lượng:
      <input type="number" style="width: 100px" class="form-control" id="qty-cart" value="1" min="1"/>
    </div>
    <span>
      <button id="buy-now" value="{{ product.id }}" class="btn btn-danger"><i class="fa-solid fa-cart-shopping"></i>  MUA NGAY</button>
      <button id="add-cart" value="{{ product.id }}" class="btn btn-dark"><i class="fa-solid fa-cart-plus"></i>  THÊM VÀO GIỎ HÀNG</button>
  </div>
</div>
<hr>
<div style="text-align: center;">CÓ THỂ BẠN QUAN TÂM</div>
<div style="text-align: center;"><i class="fa-solid fa-angle-down"></i></div>
<div class="container text-center">
  <div class="row justify-content-center">
    {% for product in care_products %}
    <div class="card col-2 m-2" style="padding-left: 0 !important; padding-right: 0 !important;">
      <img src="{{ product.img1 }}" class="card-img-top" alt="Ảnh sản phẩm" style="aspect-ratio: 208/181; overflow: hidden; object-fit: cover;">
      <div class="card-body">
        <div class="card-title">
          <a href="/products/{{ product.slug }}/" style="text-decoration: none;">{{ product.title|upper }}</a>
        </div>
        {% if product.sale_price %}
        <strike class="text-secondary" style="font-size: 14px;">{{product.price}}₫</strike>
        <span>{{ product.sale_price }}₫</span>
        {% else %}
        <span>{{ product.price }}₫</span>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
</div>
<hr>
<div class="border text-center mb-3">
  <h3 class="mt-3">CAM KẾT</h3>
  <div class="container" style="text-align: center; width: 60vw;">
    <p>Trang sức phong thuỷ Mixi - Thương hiệu trang sức phong thuỷ hàng đầu tại Việt Nam, cảm ơn quý khách đã cùng đồng hành trong suốt thời gian qua. Chúng tôi luôn mong muốn mang đến cho quý khách hàng những giá trị tốt nhất với dịch vụ thanh toán tiện lợi, giao hàng nhanh chóng, đăc biệt có xưởng chế tác theo yêu cầu bởi nghệ nhân đá.</p>
  </div>
  <div class="container row mb-4">
    <div class="d-flex gap-2 col-3 justify-content-center" style="align-items: center;">
      <div class=""><img width="75px" src="https://theme.hstatic.net/200000920459/1001293071/14/brand_1.jpg?v=378" alt="Ảnh"></div>
      <div class="">Tư vấn hoàn toàn miễn phí</div>
    </div>
    <div class="d-flex gap-2 col-3 justify-content-center" style="align-items: center;">
      <div><img width="75px" src="https://theme.hstatic.net/200000920459/1001293071/14/brand_3.jpg?v=378" alt="Ảnh"></div>
      <div>Sản phẩm đá tự nhiên</div>
    </div>
    <div class="d-flex gap-2 col-3 justify-content-center" style="align-items: center;">
      <div><img width="75px" src="https://theme.hstatic.net/200000920459/1001293071/14/brand_2.jpg?v=378" alt="Ảnh"></div>
      <div>Sản phẩm đạt tiêu chuẩn kiểm định</div>
    </div>
    <div class="d-flex gap-2 col-3 justify-content-center" style="align-items: center;">
      <div><img width="75px" src="https://theme.hstatic.net/200000920459/1001293071/14/brand_4.jpg?v=378" alt=""></div>
      <div>Sản phẩm được trì chú</div>
    </div>
  </div>
</div>


<script>
  $(document).on("click", "#add-cart", function (e) {
    e.preventDefault();
    var product_id = $("#add-cart").val();
    var product_qty = $("#qty-cart").val();
    var data = {
      product_id: product_id,
      product_qty: product_qty,
      csrfmiddlewaretoken: "{{ csrf_token }}",
      action: "post",
    };
    $.ajax({
      type: "POST",
      url: "{% url 'cart-add' %}",
      data: data,
      success: function (json) {
        $("#cart-quantity").text(json.qty);
      },
      error: function (xhr, errmsg, err) {},
    });
  });

  $(document).on("click", "#buy-now", function (e) {
    e.preventDefault();
    var product_id = $("#add-cart").val();
    var product_qty = $("#qty-cart").val();
    var data = {
      product_id: product_id,
      product_qty: product_qty,
      csrfmiddlewaretoken: "{{ csrf_token }}",
      action: "post",
    };
    $.ajax({
      type: "POST",
      url: "{% url 'cart-add' %}",
      data: data,
      success: function (json) {
        window.location.href = "{% url 'checkout' %}";
      },
      error: function (xhr, errmsg, err) {},
    });
  });
</script>

{% endblock %}